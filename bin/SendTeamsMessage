#!/usr/bin/env python3
import pymsteams
import argparse
import sys

parser = argparse.ArgumentParser(description='Send message to your Teams chanel')

parser.add_argument('-t',
                    '--title',
                    dest='title',
                    help='Card title')
parser.add_argument('-m',
                    '--message',
                    dest='message',
                    help='Card message text')
parser.add_argument('-H',
                    '--webhook',
                    dest='webhook',
                    help='Your channel webhook')
parser.add_argument('-s',
                    '--summary',
                    dest='summary',
                    help='Card summary text')
parser.add_argument('--send-ok',
                    action='store_true',
                    dest='ok',
                    help='Put red color in the card or if not put red color')


args = parser.parse_args()
num = len(sys.argv)
if num < 9:
 print(num)
 parser.print_help()
 sys.exit(0)

red = "#FF5733"
green = "#B2FF33"

if args.ok:
  color = green
else:
  color = red

myTeamsMessage = pymsteams.connectorcard(args.webhook)
myTeamsMessage.title(args.title)
myTeamsMessage.summary(args.summary)
myTeamsMessage.text(args.message)
myTeamsMessage.color(color)
myTeamsMessage.send()
